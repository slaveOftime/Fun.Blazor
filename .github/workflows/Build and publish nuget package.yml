name: Build and publish nuget packages

on:
    push:
        branches:
        - master
        paths:
        - "**/CHANGELOG.md"
        - ".github/workflows/Build and publish nuget package.yml"
        - "build.fsx"

jobs:
  build-and-push-nuget-packages:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v5

    - name: Setup .NET Core
      uses: actions/setup-dotnet@v5
      with:
        dotnet-version: 10.0.x 

    - name: Run build.fsx
      env:
        NUGET_API_KEY: ${{ secrets.NUGET_API_KEY }}
      run: dotnet fsi build.fsx -- -p packages
